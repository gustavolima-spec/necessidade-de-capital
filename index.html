<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Simulador de Operações | FAN Capital</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body {
    margin: 0;
    font-family: Arial, Helvetica, sans-serif;
    background: #f2f2f2;
}

.container {
    background: #ffffff;
    width: 100%;
    max-width: 520px;
    margin: 0 auto;
    padding: 28px 24px;
    min-height: 100vh;
}

.logo-img {
    text-align: center;
    margin-bottom: 6px;
}

.logo-img img {
    max-width: 220px;
    width: 80%;
    height: auto;
}

h2 {
    text-align: center;
    font-weight: normal;
    margin-top: 4px;
    margin-bottom: 22px;
    color: #333;
}

label {
    display: block;
    margin-top: 16px;
    font-size: 14px;
    color: #555;
}

input,
button {
    width: 100%;
    box-sizing: border-box;
}

input {
    padding: 16px;
    margin-top: 6px;
    font-size: 16px;
    border-radius: 10px;
    border: 1px solid #ccc;
}

button {
    padding: 16px;
    margin-top: 24px;
    font-size: 17px;
    border: none;
    border-radius: 10px;
    background: #e53935;
    color: #fff;
    cursor: pointer;
}

button.secondary {
    background: #555;
    margin-top: 14px;
}

.resultado {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid #ddd;
    font-size: 16px;
}

.valor {
    color: #e53935;
    font-weight: bold;
}

.breakdown {
    margin-top: 20px;
    background: #fafafa;
    padding: 16px;
    border-radius: 10px;
    font-size: 14px;
    color: #444;
}

@media (min-width: 768px) {
    body {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .container {
        border-radius: 16px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        min-height: auto;
    }
}
</style>
</head>

<body>

<div class="container">

    <div class="logo-img">
        <img src="https://fancapital.com.br/wp-content/uploads/2025/07/download_-3-1889x1080.png" alt="FAN Capital">
    </div>

    <h2>Simulador de Operações</h2>

    <label>Valor bruto da operação</label>
    <input id="valorBruto" placeholder="R$ 0,00" oninput="mascaraMoeda(this)">

    <label>Taxa de juros (% ao mês)</label>
    <input id="taxa" placeholder="0,00" oninput="mascaraPercentual(this)">

    <label>Prazo médio (dias)</label>
    <input id="prazo" placeholder="0,00" oninput="mascaraDecimal2(this)">

    <button onclick="simular()">Simular operação</button>
    <button class="secondary" onclick="gerarPDF()">Exportar PDF</button>

    <div class="resultado">
        Receita operacional:
        <span class="valor" id="receita">R$ 0,00</span><br><br>
        Valor líquido da operação:
        <span class="valor" id="liquido">R$ 0,00</span>
    </div>

    <div class="breakdown" id="breakdown">
        <strong>Breakdown do cálculo</strong><br><br>
        Preencha os campos e clique em <b>Simular operação</b>.
    </div>

</div>

<script>
function mascaraMoeda(campo) {
    let v = campo.value.replace(/\D/g,'');
    v = (v / 100).toFixed(2);
    v = v.replace('.', ',');
    v = v.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
    campo.value = 'R$ ' + v;
}

function mascaraPercentual(campo) {
    let v = campo.value.replace(/\D/g,'');
    v = (v / 100).toFixed(2).replace('.', ',');
    campo.value = v;
}

function mascaraDecimal2(campo) {
    let v = campo.value.replace(/\D/g,'');
    v = (v / 100).toFixed(2).replace('.', ',');
    campo.value = v;
}

function parseMoeda(v) {
    return parseFloat(v.replace(/[R$\s.]/g,'').replace(',','.')) || 0;
}

function parseDecimal(v) {
    return parseFloat(v.replace(',','.')) || 0;
}

function moeda(v) {
    return v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
}

let dados = {};

function simular() {
    const bruto = parseMoeda(valorBruto.value);
    const taxaMes = parseDecimal(taxa.value) / 100;
    const prazoDias = parseDecimal(prazo.value);

    if (bruto <= 0 || taxaMes <= 0 || prazoDias <= 0) {
        alert("Preencha todos os campos corretamente.");
        return;
    }

    const taxaDia = taxaMes / 30;
    const receita = taxaDia * prazoDias * bruto;
    const liquido = bruto - receita;

    document.getElementById("receita").innerText = moeda(receita);
    document.getElementById("liquido").innerText = moeda(liquido);

    document.getElementById("breakdown").innerHTML = `
        <strong>Breakdown do cálculo</strong><br><br>
        Valor bruto da operação: ${moeda(bruto)}<br>
        Taxa mensal: ${(taxaMes * 100).toFixed(2)}%<br>
        Taxa diária equivalente: ${(taxaDia * 100).toFixed(4)}%<br>
        Prazo médio: ${prazoDias.toFixed(2)} dias<br><br>
        Receita operacional apurada no período.<br>
        Valor líquido calculado após a dedução da receita.
    `;

    dados = { bruto, taxaMes, prazoDias, receita, liquido };
}

function gerarPDF() {
    if (!dados.bruto) {
        alert("Faça a simulação antes de exportar.");
        return;
    }

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF();

    pdf.text("FAN Capital", 20, 20);
    pdf.text("Simulador de Operações", 20, 30);

    pdf.text(`Valor Bruto: ${moeda(dados.bruto)}`, 20, 50);
    pdf.text(`Taxa Mensal: ${(dados.taxaMes * 100).toFixed(2)}%`, 20, 60);
    pdf.text(`Prazo Médio: ${dados.prazoDias.toFixed(2)} dias`, 20, 70);
    pdf.text(`Receita Operacional: ${moeda(dados.receita)}`, 20, 90);
    pdf.text(`Valor Líquido: ${moeda(dados.liquido)}`, 20, 100);

    pdf.save("simulacao-operacao-fan-capital.pdf");
}

// garante que a página sempre abra limpa
window.onload = () => {
    valorBruto.value = "";
    taxa.value = "";
    prazo.value = "";
};
</script>

</body>
</html>
